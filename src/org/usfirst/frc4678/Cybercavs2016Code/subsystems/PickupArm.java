// RobotBuilder Version: 2.0
//
// This file was generated by RobotBuilder. It contains sections of
// code that are automatically generated and assigned by robotbuilder.
// These sections will be updated in the future when you export to
// Java from RobotBuilder. Do not put any code or make any change in
// the blocks indicating autogenerated code or it will be lost on an
// update. Deleting the comments indicating the section will prevent
// it from being updated in the future.

package org.usfirst.frc4678.Cybercavs2016Code.subsystems;

import org.usfirst.frc4678.Cybercavs2016Code.Robot;
import org.usfirst.frc4678.Cybercavs2016Code.RobotMap;
import org.usfirst.frc4678.Cybercavs2016Code.commands.setPickupArm;

import edu.wpi.first.wpilibj.AnalogInput;
import edu.wpi.first.wpilibj.CANTalon;
import edu.wpi.first.wpilibj.CANTalon.TalonControlMode;
import edu.wpi.first.wpilibj.DigitalInput;
import edu.wpi.first.wpilibj.PowerDistributionPanel;
import edu.wpi.first.wpilibj.command.Subsystem;

/**
 *
 */
public class PickupArm extends Subsystem {
	public int pickupState = 0;
	PowerDistributionPanel pdp = new PowerDistributionPanel();
	int count = 0;
	String armMode;

	// BEGIN AUTOGENERATED CODE, SOURCE=ROBOTBUILDER ID=CONSTANTS

    // END AUTOGENERATED CODE, SOURCE=ROBOTBUILDER ID=CONSTANTS

	// BEGIN AUTOGENERATED CODE, SOURCE=ROBOTBUILDER ID=DECLARATIONS
    private final CANTalon pickupElbowMotor = RobotMap.pickupArmpickupElbowMotor;
    private final CANTalon pickupWristMotor = RobotMap.pickupArmpickupWristMotor;
    private final CANTalon pickupWheels = RobotMap.pickupArmpickupWheels;
    private final DigitalInput ballSensor = RobotMap.pickupArmballSensor;
    private final DigitalInput backBallSensor = RobotMap.pickupArmbackBallSensor;

    // END AUTOGENERATED CODE, SOURCE=ROBOTBUILDER ID=DECLARATIONS

	// Put methods for controlling this subsystem
	// here. Call these from Commands.

	public void initDefaultCommand() {
		// BEGIN AUTOGENERATED CODE, SOURCE=ROBOTBUILDER ID=DEFAULT_COMMAND

        setDefaultCommand(new setPickupArm());

    // END AUTOGENERATED CODE, SOURCE=ROBOTBUILDER ID=DEFAULT_COMMAND

		// Set the default command for a subsystem here.
		// setDefaultCommand(new MySpecialCommand());
	}

	//////////////////////////////////////
	////////// Access functions//////////
	/////////////////////////////////////

	public int getElbowPosition() {
		return pickupElbowMotor.getEncPosition();
	}

	public int getWristPosition() {
		return pickupWristMotor.getEncPosition();
	}

	public int getPickupWheelsPosition() {
		return pickupWheels.getEncPosition();
	}

	public double getCurrent(int channel) {
		return pdp.getCurrent(channel);
	}

	////////////////////////////////////////////////////
	////////// Functions to set Arms positions//////////
	////////////////////////////////////////////////////

	public void setElbowPosition(int position) {
		pickupElbowMotor.configPeakOutputVoltage(+8f, -8f);
		pickupElbowMotor.setPID(0.15, 0, 0);
		pickupElbowMotor.set(position);
	}

	public void setWristPosition(int position) {
		pickupWristMotor.configPeakOutputVoltage(+8f, -8f);
		pickupWristMotor.setPID(0.15, 0, 0);
		pickupWristMotor.setAllowableClosedLoopErr(700);
		pickupWristMotor.set(position);
	}

	public void setPickupWheels(double voltage) {
		pickupWheels.set(voltage);
	}

	public void stopArmMotors() {
		pickupElbowMotor.disable();
		pickupWristMotor.disable();
		pickupWheels.disable();
	}

	public void setPickupWheelsMode(int mode) {
		if (mode == 0) {
			pickupWheels.changeControlMode(TalonControlMode.Current);
		}
		if (mode == 1) {
			pickupWheels.changeControlMode(TalonControlMode.Disabled);
		}
		if (mode == 2) {
			pickupWheels.changeControlMode(TalonControlMode.Follower);
		}
		if (mode == 3) {
			pickupWheels.changeControlMode(TalonControlMode.MotionProfile);
		}
		if (mode == 4) {
			pickupWheels.changeControlMode(TalonControlMode.PercentVbus);
		}
		if (mode == 5) {
			pickupWheels.changeControlMode(TalonControlMode.Position);
		}
		if (mode == 6) {
			pickupWheels.changeControlMode(TalonControlMode.Speed);
		}
		if (mode == 7) {
			pickupWheels.changeControlMode(TalonControlMode.Voltage);
		}
	}

	public void setElbowMode(int mode) {
		if (mode == 0) {
			pickupElbowMotor.changeControlMode(TalonControlMode.Current);
		}
		if (mode == 1) {
			pickupElbowMotor.changeControlMode(TalonControlMode.Disabled);
		}
		if (mode == 2) {
			pickupElbowMotor.changeControlMode(TalonControlMode.Follower);
		}
		if (mode == 3) {
			pickupElbowMotor.changeControlMode(TalonControlMode.MotionProfile);
		}
		if (mode == 4) {
			pickupElbowMotor.changeControlMode(TalonControlMode.PercentVbus);
		}
		if (mode == 5) {
			pickupElbowMotor.changeControlMode(TalonControlMode.Position);
		}
		if (mode == 6) {
			pickupElbowMotor.changeControlMode(TalonControlMode.Speed);
		}
		if (mode == 7) {
			pickupElbowMotor.changeControlMode(TalonControlMode.Voltage);
		}
	}

	public void setWristMode(int mode) {
		if (mode == 0) {
			pickupWristMotor.changeControlMode(TalonControlMode.Current);
		}
		if (mode == 1) {
			pickupWristMotor.changeControlMode(TalonControlMode.Disabled);
		}
		if (mode == 2) {
			pickupWristMotor.changeControlMode(TalonControlMode.Follower);
		}
		if (mode == 3) {
			pickupWristMotor.changeControlMode(TalonControlMode.MotionProfile);
		}
		if (mode == 4) {
			pickupWristMotor.changeControlMode(TalonControlMode.PercentVbus);
		}
		if (mode == 5) {
			pickupWristMotor.changeControlMode(TalonControlMode.Position);
		}
		if (mode == 6) {
			pickupWristMotor.changeControlMode(TalonControlMode.Speed);
		}
		if (mode == 7) {
			pickupWristMotor.changeControlMode(TalonControlMode.Voltage);
		}
	}

	public void stopIntakeWheels() {
		pickupWheels.disable();
	}

	public void resetArmEncValues() {
		pickupElbowMotor.setEncPosition(0);
		pickupWristMotor.setEncPosition(0);
	}
	public int getWristAngular() {
		return pickupWristMotor.getPulseWidthPosition();
	}
	public int getElbowAngular() {
		return pickupElbowMotor.getPulseWidthPosition();
	}
	public boolean getBackSensor() {
		return backBallSensor.get();
	}
	public void resetPickupState() {
		pickupState = 0;
	}
	public void setPickupInitPos() {
		pickupWristMotor.setEncPosition(pickupWristMotor.getPulseWidthPosition());
		pickupElbowMotor.setEncPosition(pickupElbowMotor.getPulseWidthPosition());
	}
	public void pickup() {
		switch(pickupState) {
		case 0:
			setPickupWheels(Robot.pickupWheelsPower());
			setWristPosition(Robot.wristPullInPosition());
			setElbowPosition(Robot.pickupElbowPosition());
			if (!backBallSensor.get()) {
				count++;			
			}
			else {
				count = 0;
			}
			if (count > 15) {
				pickupState++;
				count = 0;
			}
			System.out.println("Count: " + count);
		break;
		case 1:
			//System.out.println("IN CASE 1!!!!");
			setWristPosition(Robot.wristPullInPosition() + 1000);
			setElbowPosition(Robot.pickupElbowPosition() + 2000);
			if (!ballSensor.get()) {
				pickupState++;
			}
		break;
		case 2:
			//System.out.println("IN CASE 2!!!!!");	
			setElbowPosition(Robot.holdElbowPosition() + 5000);
			count++;
			if (count > 15) {
				setPickupWheels(0);
				setArmMode("Hold");
				count = 0;
			}
		break;
		}
	}
	public void holdPosition() {
		setWristPosition(Robot.holdWristPosition());
		setElbowPosition(Robot.holdElbowPosition());
		setPickupWheels(0);
	}
	public void spitOut() {
	}
	public void setArmMode(String Mode) {
		armMode = Mode;
	}
	public String getArmMode() {
		return armMode;
	}
}
